<!-- index.html ‚Äî Chat Simulator (√≠cone de "olho" e bot√£o de √°udio corrigido) -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chat Simulator</title>
  <style>
    :root {
      --blue: #93c5fd;
      --green: #86efac;
      --gray-bg: #f3f4f6;
      --gray-border: #d1d5db;
      --primary: #2563eb;
    }
    html, body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: var(--gray-bg);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .card {
      background: #fff;
      padding: 1.5rem;
      border-radius: .75rem;
      box-shadow: 0 2px 6px rgba(0,0,0,.08);
      width: 100%;
      max-width: 380px;
    }
    .btn {
      width: 100%;
      padding: .5rem 1rem;
      margin-top: .5rem;
      border: none;
      border-radius: .5rem;
      font-weight: 600;
      cursor: pointer;
    }
    .btn.primary { background: var(--primary); color: #fff; }
    .btn.secondary { background: #e5e7eb; }
    .btn.ghost { background: transparent; color: var(--primary); }
    .chat-scroll { max-height: 340px; overflow-y: auto; }
    .chat-bubble {
      max-width: 70%;
      padding: .75rem;
      border-radius: 1rem;
      box-shadow: 0 1px 3px rgba(0,0,0,.1);
    }
    .bubble-a { background: var(--blue); }
    .bubble-b { background: var(--green); }
    input[type=text] {
      flex: 1;
      padding: .5rem;
      border: 1px solid var(--gray-border);
      border-radius: .5rem;
      outline: none;
    }
    .flex { display: flex; }
    .gap-md { gap: .75rem; }
    .search-box { margin-bottom: 1rem; }
    .hint-btn, .audio-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
      padding: 0 .25rem;
      line-height: 1;
    }
    .input-group {
      position: relative;
      display: flex;
      align-items: center;
      width: 100%;
    }
    .hint-bubble {
      position: absolute;
      right: 3.5rem;
      bottom: 120%;
      background: #333;
      color: #fff;
      padding: .25rem .5rem;
      border-radius: .25rem;
      font-size: .75rem;
      white-space: pre-wrap;
      display: none;
      max-width: 220px;
    }
    .hint-bubble::after {
      content: '';
      position: absolute;
      bottom: -6px;
      right: 10px;
      border-width: 6px 6px 0 6px;
      border-style: solid;
      border-color: #333 transparent transparent transparent;
    }
  </style>
</head>
<body>
  <div id="app" class="card"></div>

  <script>
    // 1. Dados
    const conversationData = {
      conversas: [

        // ************ Entrevistas
        {
          title: '[Entrevista] comportamental',
          A: [
            { id: '1', pergunta: 'Hi Guilherme, it‚Äôs great to meet you! Can you hear and see me okay?', audio: 'audio/behavioral-interview/1.mp3' },
            { id: '2', pergunta: 'Perfect. I‚Äôm really glad we could connect. Just to give you a quick idea this will be about a 45 minute chat. I‚Äôll ask a few background questions, then some behavioral ones, and we‚Äôll finish with your questions. Sound good?', audio: 'audio/behavioral-interview/3.mp3' },
            { id: '3', pergunta: "Can you tell me about yourself and your professional background? let's start with the company luizalabs.", audio: 'audio/behavioral-interview/5.mp3' },
            { id: '4', pergunta: "tell me about everis.", audio: 'audio/behavioral-interview/7.mp3'},
            { id: '5', pergunta: "tell me about tembici.", audio: 'audio/behavioral-interview/9.mp3'},
            { id: '6', pergunta: "tell me about Santander bank.", audio: 'audio/behavioral-interview/11.mp3'},
            { id: '7', pergunta: "Why are you looking for new opportunities?", audio: 'audio/behavioral-interview/13.mp3'},
            { id: '8', pergunta: "Can you tell me about a time when you faced a significant challenge in a project, and how you handled it?", audio: 'audio/behavioral-interview/15.mp3'},
            { id: '9', pergunta: "Tell me about a time you received critical feedback. How did you handle it?", audio: 'audio/behavioral-interview/17.mp3'},
            { id: '10', pergunta: "Thanks again, Guilherme! You‚Äôve shared some really strong examples we‚Äôll be in touch soon after reviewing internally.", audio: 'audio/behavioral-interview/19.mp3'},
          ],
          B: [
            { id: '1', resposta: 'Hi! Yes, everything‚Äôs working fine. Thanks for having me today.', audio: 'audio/behavioral-interview/2.mp3' },
            { id: '2', resposta: 'Absolutely, sounds good.', audio: 'audio/behavioral-interview/4.mp3' },
            { id: '3', resposta: 'I‚Äôm currently a Senior Software Developer at Luizalabs, where I focus on backend solutions using Python with FastAPI, MongoDB, Kafka, Kubernetes and ArgoCD. In this role, I‚Äôve had the opportunity to worked on back-office applications that manage sellers and leads interested in selling on Magazine Luiza, a major retail company in Brazil. One of my main contributions here was building a risk analysis system that replaced an external legacy system, saving R$200,000 per year.', audio: 'audio/behavioral-interview/6.mp3' },
            { id: '4', resposta: 'Before Luizalabs, I worked as a Mid-level Software Engineer at Everis, where I worked on B2B product team for ambev. There, I worked with Python, Django, Postgres, RabbitMQ and AWS.', audio: 'audio/behavioral-interview/8.mp3' },
            { id: '5', resposta: 'before everis, I worked as a Mid-level Software Engineer at Tembici, where I worked on the IFood Pedal project, a bike rental app with over 18,000 delivery drivers.,The project won the Innovation of the Year award. There, I worked with Python, Django, Postgres, Celery and AWS', audio: 'audio/behavioral-interview/10.mp3' },
            { id: '6', resposta: 'Finally, I started my career at Santander Bank as an Entry-Level Software Developer, working on both backend Python, Flask, React for payment team.', audio: 'audio/behavioral-interview/12.mp3' },
            { id: '7', resposta: "I'm looking for a place where I can work in English daily and work with people from all over the world.", audio: 'audio/behavioral-interview/14.mp3'},
            { id: '8', resposta: "One project where I faced a significant challenge was building an internal risk analysis tools for sellers at Luizalabs. It replaced an expensive legacy system and saved the company 200,000 per year. The project was challenging because the legacy system had no proper documentation, and the new risk analysis API was being developed in parallel with the frontend. I handled this by leading daily meetings to align both frontend and backend teams and ensuring new documentation was up to date", audio: 'audio/behavioral-interview/14.mp3'},
            { id: '9', resposta: "At Santander, I received feedback from my tech lead that my SQL queries were too complex and hard to maintain. Instead of getting defensive, I asked for guidance and took the opportunity to refactor my code. I rewrote the queries to be cleaner and easier to understand.", audio: 'audio/behavioral-interview/18.mp3'},
            { id: '10', resposta: "Thank you! I really appreciate your time.", audio: 'audio/behavioral-interview/20.mp3'},
          ]
        },

        // ************ dia a dia


        // ************** dia a dia dev
        {
          title: '[Scenario Dev] 1 Daily Standup',
          A: [
            { id: '1', pergunta: 'Good morning, everyone! Let‚Äôs start with Guilherme.', audio: 'audio/scenario-1-daily-standup/1.mp3' },
            { id: '2', pergunta: 'Any blockers?', audio: 'audio/scenario-1-daily-standup/3.mp3' },
            { id: '3', pergunta: 'I can pair with you after the standup.', audio: 'audio/scenario-1-daily-standup/5.mp3' },
            { id: '4', pergunta: 'What‚Äôs your focus today?', audio: 'audio/scenario-1-daily-standup/7.mp3' }
          ],
          B: [
            { id: '1', resposta: 'Yesterday, I worked on fixing the bug in the checkout flow.', audio: 'audio/scenario-1-daily-standup/2.mp3' },
            { id: '2', resposta: 'Yes, I need help understanding the new discount logic.', audio: 'audio/scenario-1-daily-standup/4.mp3' },
            { id: '3', resposta: 'Perfect, that‚Äôll help a lot.', audio: 'audio/scenario-1-daily-standup/6.mp3' },
            { id: '4', resposta: 'I‚Äôll finalize the fix and write tests for the discount module.', audio: 'audio/scenario-1-daily-standup/8.mp3' }
          ]
        },
        {
          title: '[Scenario Dev] 2 Pair Programming',
          A: [
            { id: '1', pergunta: 'Hey Bill, can we pair on the new onboarding screen?', audio: 'audio/scenario-2-pair-programming/1.mp3' },
            { id: '2', pergunta: 'I added the layout, but I‚Äôm unsure about handling form validation.', audio: 'audio/scenario-2-pair-programming/3.mp3' },
            { id: '3', pergunta: 'Oh, right! That will simplify the code.', audio: 'audio/scenario-2-pair-programming/5.mp3' },
            { id: '4', pergunta: 'Good point. Done! Want to review together?', audio: 'audio/scenario-2-pair-programming/7.mp3' }
          ],
          B: [
            { id: '1', resposta: "Sure. Do you want to walk me through what you've done so far?", audio: 'audio/scenario-2-pair-programming/2.mp3' },
            { id: '2', resposta: 'Let‚Äôs use a custom hook for that. We already have one for forms.', audio: 'audio/scenario-2-pair-programming/4.mp3' },
            { id: '3', resposta: 'Can you also extract the error messages into a constants file?', audio: 'audio/scenario-2-pair-programming/6.mp3' },
            { id: '4', resposta: 'Looks good! Just add a test for the success case.', audio: 'audio/scenario-2-pair-programming/8.mp3' }
          ]
        }
      ]
    };

    // 2. Estado
    let stage = 'titles', selectedConv = null, role = null, step = 0, history = [], searchTerm = '';
    const app = document.getElementById('app');

    // 3. Util
    const scrollToBottom = () => {
      const box = document.getElementById('chat-scroll'); if (box) box.scrollTop = box.scrollHeight;
    };
    const player = new Audio();
    const playAudio = src => { if (!src) return; try { player.pause(); player.currentTime = 0; player.src = src; player.play(); } catch {} };
    const pushMessage = msg => { history.push(msg); if (msg.audio) playAudio(msg.audio); };

    // 4. Render
    const render = () => { if (stage === 'titles') return renderTitles(); if (stage === 'role') return renderRoles(); return renderChat(); };

    // 4.1 T√≠tulos
    function renderTitles() {
      app.innerHTML = `
        <h2 style="text-align:center;margin-bottom:1rem">Escolha um Cen√°rio</h2>
        <div class="search-box flex gap-md">
          <input id="search-input" type="text" placeholder="Buscar‚Ä¶" value="${searchTerm}" />
        </div>
        <div id="scenario-list"></div>`;
      document.getElementById('search-input').addEventListener('input', e => { searchTerm = e.target.value; renderScenarioList(); });
      renderScenarioList(); document.getElementById('search-input').focus();
    }
    function renderScenarioList() {
      const list = document.getElementById('scenario-list');
      const filtered = conversationData.conversas.filter(c => c.title.toLowerCase().includes(searchTerm.toLowerCase()));
      list.innerHTML = filtered.length
        ? filtered.map((c, idx) => `<button class="btn primary" onclick="chooseConversation(${idx})">${c.title}</button>`).join('')
        : `<p style="text-align:center;color:#6b7280">Nenhum cen√°rio encontrado</p>`;
    }

    // 4.2 Roles
    function renderRoles() {
      app.innerHTML = `
        <h2 style="text-align:center;margin-bottom:1rem">Quem voc√™ quer ser?</h2>
        <div class="flex gap-md">
          <button class="btn primary" style="flex:1" onclick="chooseRole('A')">Pessoa A</button>
          <button class="btn primary" style="flex:1" onclick="chooseRole('B')">Pessoa B</button>
        </div>
        <button class="btn ghost" onclick="setStage('titles')">Voltar</button>`;
    }

    // 4.3 Chat
    function renderChat() {
      const conv = conversationData.conversas[selectedConv];
      const finished = (role === 'A' && step >= conv.A.length) || (role === 'B' && step >= conv.B.length);
      const historyHTML = history.map(msg => {
        const align = msg.speaker === role ? 'flex-end' : 'flex-start';
        const bubClass = msg.speaker === 'A' ? 'bubble-a' : 'bubble-b';
        const audHTML = msg.audio ? `<audio controls style="width:100%;margin-top:.5rem"><source src="${msg.audio}" type="audio/mpeg"></audio>` : '';
        return `<div style="display:flex;justify-content:${align}"><div class="chat-bubble ${bubClass}"><p style="margin:0">${msg.text}</p>${audHTML}</div></div>`;
      }).join('');
      const inputBlock = finished
        ? `<div style="text-align:center;color:#6b7280">Fim da conversa üéâ</div>`
        : `
        <div class="input-group flex gap-md" style="margin-top:.75rem">
          <input id="chat-input" type="text" placeholder="Digite e tecle Enter‚Ä¶" />
          <button id="hint-btn" class="hint-btn">üëÅ</button>
          <button id="audio-btn" class="audio-btn">üîä</button>
          <button class="btn primary" style="width:auto" onclick="send()">Enviar</button>
          <div id="hint-bubble" class="hint-bubble"></div>
        </div>`;
      app.innerHTML = `<div id="chat-scroll" class="chat-scroll space-y">${historyHTML}</div>${inputBlock}<div class="flex gap-md" style="margin-top:1rem;justify-content:space-between"><button class="btn secondary" onclick="setStage('role')">Trocar Papel</button><button class="btn secondary" onclick="setStage('titles')">Novo Cen√°rio</button></div>`;

      const chatInput = document.getElementById('chat-input');
      const hintBtn = document.getElementById('hint-btn');
      const audioBtn = document.getElementById('audio-btn');
      const hintBubble = document.getElementById('hint-bubble');
      if (chatInput && hintBtn && audioBtn && hintBubble) {
        const hintText = role === 'A' ? (conv.A[step]?.pergunta || '') : (conv.B[step]?.resposta || '');
        const hintAudio = role === 'A' ? (conv.A[step]?.audio || '') : (conv.B[step]?.audio || '');
        hintBubble.textContent = hintText;
        hintBtn.onmouseenter = () => { if (hintText) hintBubble.style.display = 'block'; };
        hintBtn.onmouseleave = () => { hintBubble.style.display = 'none'; };
        hintBtn.onclick     = () => { hintBubble.style.display = hintBubble.style.display === 'block' ? 'none' : 'block'; };
        audioBtn.onclick    = () => { if (hintAudio) playAudio(hintAudio); };
        chatInput.focus();
        chatInput.onkeydown = e => { if (e.key === 'Enter') { e.preventDefault(); send(); } };
      }

      scrollToBottom();
    }

    // 5. Actions
    window.chooseConversation = idx => { selectedConv = idx; step = 0; history = []; stage = 'role'; render(); };
    window.chooseRole         = r   => { role = r; stage = 'chat'; if (r === 'B') { const first = conversationData.conversas[selectedConv].A[0]; pushMessage({ speaker:'A', text:first.pergunta, audio:first.audio }); step = 0; } render(); };
    window.setStage           = s   => { stage = s; render(); };
    window.send               = ()  => { const input = document.getElementById('chat-input'); if (!input || !input.value.trim()) return; const text = input.value.trim(); const conv = conversationData.conversas[selectedConv]; const userLine = role === 'A' ? conv.A[step] : conv.B[step]; pushMessage({ speaker:role, text, audio:userLine?.audio || null }); const replyLine = role === 'A' ? conv.B[step] : conv.A[step+1]; if (replyLine) pushMessage({ speaker:role==='A'?'B':'A', text:replyLine.pergunta||replyLine.resposta, audio:replyLine.audio }); step++; render(); };

    // Init
    render();
  </script>
</body>
</html>
